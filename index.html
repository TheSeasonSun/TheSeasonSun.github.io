<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>TheSeasonSun</title><meta name="author" content="TheSeasonSun"><meta name="copyright" content="TheSeasonSun"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="We have season in the sun.">
<meta property="og:type" content="website">
<meta property="og:title" content="TheSeasonSun">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="TheSeasonSun">
<meta property="og:description" content="We have season in the sun.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar1.png">
<meta property="article:author" content="TheSeasonSun">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar1.png"><link rel="shortcut icon" href="/img/favicon_16.png"><link rel="canonical" href="http://example.com/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'TheSeasonSun',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-03-17 11:11:09'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="TheSeasonSun" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar1.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background: rgb(230,229,234)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">TheSeasonSun</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">TheSeasonSun</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/02/24/%E7%8F%8D%E7%88%B1%E7%94%9F%E5%91%BD%EF%BC%8C%E8%BF%9C%E7%A6%BB%E5%BA%A6%E7%9B%98/" title="珍爱生命，远离度盘">珍爱生命，远离度盘</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-24T03:04:04.000Z" title="发表于 2023-02-24 11:04:04">2023-02-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a></span></div><div class="content">事情的起因是这样的，有群友想要一部文字游戏的资源（魔法使之夜，全年龄，TYPEMOON代表作），而我恰好有，就通过私聊分享给了他。具体过程如下：



魔法使之夜我先从小号网盘里的游戏(游戏1）分享给主网盘，保存后主网盘(游戏2）又复制了一份该游戏(游戏3，同样保存在主网盘），之后将复制出来的游戏(游戏3）又私信分享给网友，同时我自己又在电脑上开始下载该游戏(游戏2），但下载到一半暂停下载了，等到第二天时，再下载发现 游戏1 2 3 全都无法下载且无法分享。

群友举报资源的可能性很低，所以被封禁的最可能的原因是云盘官方在下载过程中查看了资源内容，然后封禁。
意识到这一点我痛定思痛，为了避免将来这种情况再次发生，我决定逐步弃用百度网盘。
而为了寻找尽可能安全的替代品，我将目光投向了OneDrive。
OneDrive扩容OneDrive个人免费容量只有5G，为了获得更多的容量，我加入了Microsoft 365 开发者计划，在这个计划中，参与人OneDrive最低可获得1T容量（空间的可以自行设置的，最高5T），最初的订阅时间只有90天，如何参与人比较活跃，使用Microsoft 36 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/09/%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95%E6%8F%90%E9%AB%98%E6%95%88%E7%8E%87/" title="如何利用主键索引提高效率">如何利用主键索引提高效率</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-09T08:49:41.000Z" title="发表于 2022-08-09 16:49:41">2022-08-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/MySQL/">MySQL</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/MySQL/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">解决方案</a></span></div><div class="content">通过本文你可以了解B+树索引的数据结构，计算机系统的内存预读机制，以及不同种类主键对B+树索引的影响从而了解如何利用主键索引提高索引效率。


情景与解决方案我曾经用SpringBoot与Vue写过一个管理电子书的项目，可以对电子书进行增删改查，主键使用uuid。在初步完成这个项目后，我造了一部分数据去测试系统效率，发现效率并不快，尤其在增加与删除数据时。
而这个效率慢与主键索引有关，这要从MySQL的数据结构说起：
MySQL有多个存储引擎，每种引擎各有特点，从索引角度来说如下：



存储引擎
索引



memory
hash


InnoDB
B+树


MyISAM
B+树


更详细的在我这篇文章：MySQL索引数据结构浅聊 | TheSeasonSun
现在最常用的是InnoDB，它的索引为B+树，数据结构如下图：

注意：在B+Tree上有两个头指针，一个指向根节点，另一个指向关键字最小的叶子节点，而且所有叶子节点（即数据节点）之间是一种链式环结构。因此B+Tree 支持两种查找运算：一种是对于主键的范围查找和分页查找，另一种是从根节点开始，进行随机查找。
当MySQL ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/07/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%97%B6%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E5%9B%9B%E5%B1%82%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%EF%BC%9F/" title="高并发时为什么是四层负载均衡？">高并发时为什么是四层负载均衡？</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-07T10:45:36.000Z" title="发表于 2022-08-07 18:45:36">2022-08-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%AB%98%E5%B9%B6%E5%8F%91/">高并发</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%AB%98%E5%B9%B6%E5%8F%91/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">解决方案</a></span></div><div class="content">在说明负载均衡模型之前应该先说以下前置知识：网络


我们都知道网络通信时网络模型，以5层模型为例，如图：

客户端发起通信的过程大致可以简略描述为以下步骤：
客户端应用层某个进程向服务端发起通信时，所发出的信息会携带该进程的端口号（通信时端口号为某个进程的具体标识），向下传递给传输控制层的TCP协议封装成报文，TCP协议再向下传输给网络层的IP协议组成报文，之后再向下在数据链路层组成MAC报文，最后交给物理层传输向其他设备。
最后的报文简单来说如下：

那么目标服务器的各个地址是如何得知的呢？
IP地址是由DNS域名向浏览器缓存，操作系统缓存等等地方解析而来的。
MAC地址是由已知的IP地址通过ARP协议广播得到的。注意MAC地址并非是目标服务器的MAC地址，而是去往目标服务器的道路上的下一个设备。
报文正是这样通过MAC地址传递到一个一个设备，最后到达服务器的。所以我们可以看到路由器和交换机都有数据链路层，因为报文需要在数据链路层来提取并再封装为新的MAC报文以传递到下一个设备。
在高并发情况下，多个请求涌向服务器会使服务器不堪重负，效率很慢，这种情况的解决方案也很朴实：多设几个服 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/05/29/MySQL%E8%B0%83%E4%BC%98%E4%B9%8B%E7%B4%A2%E5%BC%95%E5%8C%B9%E9%85%8D%E6%96%B9%E5%BC%8F%E4%B8%8E%E4%BC%98%E5%8C%96%E7%BB%86%E8%8A%82/" title="MySQL调优之索引匹配方式与优化细节">MySQL调优之索引匹配方式与优化细节</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-29T08:34:53.000Z" title="发表于 2022-05-29 16:34:53">2022-05-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/MySQL/">MySQL</a></span></div><div class="content">索引匹配方式下面举例皆在索引 idx（name，age，pos）建立前提下


全值匹配全值匹配指的是和索引中的所有列进行匹配
匹配最左前缀只匹配前面的几列
匹配列前缀可以匹配某一列的值的开头部分
比如：select * from staffs where name like ‘J%’;这个语句可以利用到用name建立的索引进行查找。但是如果是 select * from staffs where name like ‘%J%’;就无法用到。
匹配范围值可以查找某一个范围的数据
比如：explain select * from staffs where name &gt; ‘Mary’;
精确匹配某一列并范围匹配另外一列可以查询第一列的全部和第二列的部分
比如：explain select * from staffs where name = ‘July’ and age &gt; 25;
只访问索引的查询查询的时候只需要访问索引，不需要访问数据行，本质上就是覆盖索引
哈希索引哈希索引是memory存储引擎使用的索引，memory的数据文件存储在内存中，这是它效率很高的原因，但正因如此 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/05/23/MySQL%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%8C%E8%8C%83%E5%BC%8F%EF%BC%8C%E4%B8%BB%E9%94%AE%EF%BC%8C%E5%AD%97%E7%AC%A6%E9%9B%86/" title="MySQL之数据类型，范式，主键，字符集">MySQL之数据类型，范式，主键，字符集</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-23T13:03:32.000Z" title="发表于 2022-05-23 21:03:32">2022-05-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/MySQL/">MySQL</a></span></div><div class="content">要在数据类型方面优化MySQL，应该先理解MySQL的各个数据类型的特点和范围


MySQL数据类型数值类型


类型
大小
范围（有符号）
范围（无符号）
用途



TINYINT
1 Bytes
(-128，127)
(0，255)
小整数值


SMALLINT
2 Bytes
(-32 768，32 767)
(0，65 535)
大整数值


MEDIUMINT
3 Bytes
(-8 388 608，8 388 607)
(0，16 777 215)
大整数值


INT或INTEGER
4 Bytes
(-2 147 483 648，2 147 483 647)
(0，4 294 967 295)
大整数值


BIGINT
8 Bytes
(-9,223,372,036,854,775,808，9 223 372 036 854 775 807)
(0，18 446 744 073 709 551 615)
极大整数值


FLOAT
4 Bytes
(-3.402 823 466 E+38，-1.175 494 351 E-38)，0，(1.175 494 351 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/05/23/MySQL%E7%B4%A2%E5%BC%95%E7%B1%BB%E5%9E%8B%EF%BC%8C%E4%BC%98%E7%82%B9%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%88%99/" title="MySQL索引类型，优点及使用原则">MySQL索引类型，优点及使用原则</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-23T12:50:11.000Z" title="发表于 2022-05-23 20:50:11">2022-05-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/MySQL/">MySQL</a></span></div><div class="content">索引类型逻辑分类按功能分类主键索引：一张表只能有一个主键索引，不允许重复、不允许为 NULL


唯一索引：数据列不允许重复，允许为 NULL 值，一张表可有多个唯一索引，索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一
普通索引：一张表可以创建多个普通索引，一个普通索引可以包含多个字段，允许数据重复，允许 NULL 值插入
全文索引：它查找的是文本中的关键词，主要用于全文检索
按列数分类单例索引：一个索引只包含一个列，一个表可以有多个单例索引
组合索引：一个组合索引包含两个或两个以上的列。查询的时候遵循 mysql 组合索引的 “最左前缀”原则，即使用 where 时条件要按照建立索引的时候字段的排列方式放置索引才会生效
物理分类聚簇索引：指的是数据跟对应的索引列紧凑的存储在一起的数据存储方式。
非聚簇索引：数据跟索引分开存储
InnoDB和MyISAM存储引擎都默认使用B+树结构存储索引，但是只有InnoDB的主键索引才是聚簇索引，InnoDB中的辅助索引以及MyISAM使用的都是非聚簇索引。这与存储引擎的文件系统的不同有关。

存储引擎为MyISAM：

* ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/05/17/MySQL%E7%B4%A2%E5%BC%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%B5%85%E8%81%8A/" title="MySQL索引数据结构浅聊">MySQL索引数据结构浅聊</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-17T11:06:19.000Z" title="发表于 2022-05-17 19:06:19">2022-05-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/MySQL/">MySQL</a></span></div><div class="content">聊一下索引的底层数据结构，着重介绍现在用的比较广泛的B树与B+树。


hash 表hash表的数据结构在此就不多赘述了，直接说hash表的缺点：

需要大量内存空间，因为每次使用hash表的时候都需要将全量的数据加载到内存中。（memory存储引擎使用hash索引）
使用hash表时需要设计优秀的hash算法，否则会导致数据分布不均匀，浪费存储空间，查询效率低下。
hash表只能支持等值搜索，不能范围或区间搜索。比如要查询id &lt; 500的人，hash表只能从1到499依次查出来。这是hash表比较致命的缺点。

二叉树使用二叉搜索树可以使用二分查找方式查找数据，但是如果插入的数据是递增的，二叉树就会退化成链表，树的深度也很大，而树的深度与查找次数成正比（下面会解释，减少树的深度正是提高索引效率的核心思路之一）。因此单纯的二叉搜索树效率可能会低下。
那么使用二叉平衡树（AVL树）呢？二叉平衡树要求左右子树高度差不大于1，这避免了上面数据退化成链表的情况，提高了搜索效率，但是在插入数据时，二叉平衡树为了保证平衡性，插入时要进行旋转，而这降低了插入效率。此外，在数据量大的情况下，二 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/05/16/MySQL-performance-schema%E7%AE%80%E8%BF%B0/" title="MySQL performance schema简述">MySQL performance schema简述</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-16T15:14:03.000Z" title="发表于 2022-05-16 23:14:03">2022-05-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/MySQL/">MySQL</a></span></div><div class="content">performance_schema的介绍MySQL的performance schema 用于监控MySQL server在一个较低级别的运行过程中的资源消耗、资源等待等情况。


performance_schema特点
它提供了一种在数据库运行时实时检查server的内部执行情况的方法。performance_schema 数据库中的表使用performance_schema存储引擎。该数据库主要关注数据库运行过程中的性能相关的数据（information_schema主要关注server运行过程中的元数据信息）。
performance_schema通过监视server的事件来实现监视server内部运行情况， “事件”就是server内部活动中所做的任何事情以及对应的时间消耗。利用这些信息来判断server中的相关资源消耗在了哪里？一般来说，事件可以是函数调用、操作系统的等待、SQL语句执行的阶段（如sql语句执行过程中的parsing 或 sorting阶段）或者整个SQL语句与SQL语句集合。事件的采集可以方便的提供server中的相关存储引擎对磁盘文件、表I/O、表锁等 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/05/12/synchronized%E6%B5%85%E8%81%8A/" title="synchronized">synchronized</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-12T01:55:06.000Z" title="发表于 2022-05-12 09:55:06">2022-05-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/">多线程与高并发</a></span></div><div class="content">面试题模拟银行账户，对业务写方法加锁，对业务读方法不加锁，这样行不行？

不行
1234567891011121314151617181920212223242526272829303132333435363738394041424344容易产生脏读问题（dirtyRead）public class Account &#123;	String name;	double balance;		public synchronized void set(String name, double balance) &#123;		this.name = name;		try &#123;			Thread.sleep(2000);		&#125; catch (InterruptedException e) &#123;			e.printStackTrace();		&#125;				this.balance = balance;	&#125;		public /*synchronized*/ double getBalance(String name) &#123;		return this ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/05/12/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E4%B8%89%E5%A4%A7%E7%89%B9%E6%80%A7/" title="并发编程三大特性">并发编程三大特性</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-12T01:47:21.000Z" title="发表于 2022-05-12 09:47:21">2022-05-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/">多线程与高并发</a></span></div><div class="content">并发编程之可见性加入一个线程t1运行时使用一个变量（把这个变量从主存复制下来存到线程内部），这时线程t2修改了这个变量，但是t1线程无法读到修改后的变量值。这就是线程的不可见性。


123456789101112131415161718192021222324252627282930313233343536373839/** * volatile 关键字，使一个变量在多个线程间可见 * A B线程都用到一个变量，java默认是A线程中保留一份copy，这样如果B线程修改了该变量，则A线程未必知道 * 使用volatile关键字，会让所有线程都会读到变量的修改值 *  * 在下面的代码中，running是存在于堆内存的t对象中 * 当线程t1开始运行的时候，会把running值从内存中读到t1线程的工作区，在运行过程中直接使用这个copy，并不会每次都去 * 读取堆内存，这样，当主线程修改running的值之后，t1线程感知不到，所以不会停止运行 *  * 使用volatile，将会强制所有线程都去堆内存中读取running的值 *  * volatile并不能保证多个线程共同修改ru ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="page-number" href="/page/3/#content-inner">3</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">TheSeasonSun</div><div class="author-info__description">We have season in the sun.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TheSeasonSun"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JavaWeb%E7%9B%B8%E5%85%B3/"><span class="card-category-list-name">JavaWeb相关</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">Java框架</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MySQL/"><span class="card-category-list-name">MySQL</span><span class="card-category-list-count">6</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MySQL/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"><span class="card-category-list-name">解决方案</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/"><span class="card-category-list-name">多线程与高并发</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"><span class="card-category-list-name">数据结构与算法</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%9A%8F%E7%AC%94/"><span class="card-category-list-name">随笔</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%AB%98%E5%B9%B6%E5%8F%91/"><span class="card-category-list-name">高并发</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/CSS/" style="font-size: 1.1em; color: #999">CSS</a> <a href="/tags/HTML/" style="font-size: 1.1em; color: #999">HTML</a> <a href="/tags/HTTP/" style="font-size: 1.1em; color: #999">HTTP</a> <a href="/tags/JDBC/" style="font-size: 1.1em; color: #999">JDBC</a> <a href="/tags/JavaScript/" style="font-size: 1.1em; color: #999">JavaScript</a> <a href="/tags/JavaWeb%E7%9B%B8%E5%85%B3/" style="font-size: 1.5em; color: #99a9bf">JavaWeb相关</a> <a href="/tags/Java%E6%A1%86%E6%9E%B6/" style="font-size: 1.1em; color: #999">Java框架</a> <a href="/tags/MYSQL/" style="font-size: 1.1em; color: #999">MYSQL</a> <a href="/tags/MyBatis/" style="font-size: 1.1em; color: #999">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 1.4em; color: #99a5b6">MySQL</a> <a href="/tags/MySQL%E7%B4%A2%E5%BC%95/" style="font-size: 1.2em; color: #999da3">MySQL索引</a> <a href="/tags/MySQL%E8%B0%83%E4%BC%98/" style="font-size: 1.1em; color: #999">MySQL调优</a> <a href="/tags/Servlet/" style="font-size: 1.1em; color: #999">Servlet</a> <a href="/tags/Tomcat/" style="font-size: 1.1em; color: #999">Tomcat</a> <a href="/tags/XML/" style="font-size: 1.1em; color: #999">XML</a> <a href="/tags/%E4%B8%AA%E4%BA%BA%E6%8F%90%E9%AB%98/" style="font-size: 1.2em; color: #999da3">个人提高</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 1.1em; color: #999">二叉树</a> <a href="/tags/%E4%BB%A3%E7%A0%81/" style="font-size: 1.3em; color: #99a1ac">代码</a> <a href="/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/" style="font-size: 1.1em; color: #999">哈希表</a> <a href="/tags/%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95/" style="font-size: 1.1em; color: #999">回溯算法</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/" style="font-size: 1.3em; color: #99a1ac">多线程与高并发</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" style="font-size: 1.3em; color: #99a1ac">数据结构与算法</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 1.2em; color: #999da3">随笔</a> <a href="/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/" style="font-size: 1.1em; color: #999">高并发</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">24</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-03-17T03:11:09.576Z"></div></div></div></div></div></div></main><footer id="footer" style="background: rgb(230,229,234)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By TheSeasonSun</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>